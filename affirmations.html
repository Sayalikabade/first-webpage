<script>
  const affirmations = [
    { id: 1, text: "Youâ€™ve done hard things before. You can do this too." },
    { id: 2, text: "You are allowed to take up space and ask for what you need." },
    { id: 3, text: "Progress counts, even when itâ€™s quiet and unseen." },
    { id: 4, text: "Youâ€™re not behind. Youâ€™re on your own timeline." },
    { id: 5, text: "Itâ€™s okay to move slowly. Consistency beats speed." },
    { id: 6, text: "You can figure things out as you go. You always have." },
    { id: 7, text: "You are more capable than you feel in this moment." },
    { id: 8, text: "Resting is also a form of progress." },
    { id: 9, text: "Youâ€™re allowed to be proud of how far youâ€™ve come." },
    { id: 10, text: "Someone out there would be grateful to have the problems youâ€™re solving today." }
  ];

  const textEl = document.getElementById("affirmation");
  const buttonEl = document.getElementById("new-affirmation");

  // Load seen IDs from localStorage (or start with an empty array)
  function loadSeen() {
    try {
      const raw = localStorage.getItem("seenAffirmations");
      return raw ? JSON.parse(raw) : [];
    } catch (e) {
      return [];
    }
  }

  function saveSeen(seenIds) {
    localStorage.setItem("seenAffirmations", JSON.stringify(seenIds));
  }

  function getUnseenAffirmations(seenIds) {
    return affirmations.filter(a => !seenIds.includes(a.id));
  }

  function getNextAffirmation() {
    let seenIds = loadSeen();
    let unseen = getUnseenAffirmations(seenIds);

    // If user has seen all of them
    if (unseen.length === 0) {
      return {
        id: null,
        text: "Youâ€™ve seen all the affirmations I have for now ðŸ’› Come back later for more."
      };
    }

    // Pick a random one from the unseen list
    const randomIndex = Math.floor(Math.random() * unseen.length);
    const chosen = unseen[randomIndex];

    // Mark it as seen & save
    seenIds.push(chosen.id);
    saveSeen(seenIds);

    return chosen;
  }

  function setNewAffirmation() {
    const next = getNextAffirmation();
    textEl.style.opacity = 0;

    setTimeout(() => {
      textEl.textContent = next.text;
      textEl.style.opacity = 1;

      // If we reached the "no more new ones" state, disable the button
      if (next.id === null) {
        buttonEl.disabled = true;
        buttonEl.textContent = "All done for now ðŸ’›";
        buttonEl.style.opacity = 0.7;
        buttonEl.style.cursor = "default";
      }
    }, 150);
  }

  // On first load
  setNewAffirmation();

  // On click
  buttonEl.addEventListener("click", setNewAffirmation);
</script>
